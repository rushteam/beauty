# Beauty 框架示例

本目录包含了 Beauty 微服务框架的各种使用示例，展示了框架的核心功能和最佳实践。

## 📁 示例目录

### 🔐 认证和限流示例
- **`auth-ratelimit/`** - 完整的认证和限流中间件使用示例
  - 演示如何同时使用认证、限流、超时控制、熔断器等多个中间件
  - 包含多种认证方式和限流策略
  - 提供完整的监控和管理端点

### 🔄 熔断器示例
- **`circuitbreaker/`** - 熔断器中间件使用示例
  - 展示熔断器的三种状态切换
  - 演示自定义熔断策略配置
  - 包含状态监控和重置功能

### ⏱️ 超时控制示例
- **`timeout/`** - 超时控制中间件使用示例
  - 演示请求超时保护机制
  - 展示慢请求检测和统计
  - 包含全局超时管理器使用

### 🔗 中间件组合示例
- **`middleware/`** - 多中间件组合使用示例
  - 展示如何同时使用超时控制和熔断器
  - 演示自定义中间件的创建和使用
  - 包含中间件执行顺序说明

### 🌐 完整应用示例
- **`example/`** - 完整的微服务应用示例
  - 集成 gRPC、HTTP、gRPC Gateway
  - 演示服务发现（etcd、nacos）
  - 包含分布式追踪和监控
  - 展示客户端和服务端完整交互

### 🔧 简单服务示例
- **`svc/`** - 简单的 HTTP 服务示例
  - 基础的 HTTP 服务器使用
  - 演示请求和环境信息处理

## 🚀 运行示例

### 前置条件

确保你已经安装了 Go 1.21+ 版本：

```bash
go version
```

### 运行单个示例

```bash
# 运行认证和限流示例
cd example/auth-ratelimit
go run main.go

# 运行熔断器示例
cd example/circuitbreaker  
go run main.go

# 运行超时控制示例
cd example/timeout
go run main.go

# 运行中间件组合示例
cd example/middleware
go run main.go
```

### 编译所有示例

```bash
# 在项目根目录下
go build ./example/...
```

## 📊 示例特性对比

| 示例 | 认证 | 限流 | 超时 | 熔断 | gRPC | HTTP | 监控 |
|------|------|------|------|------|------|------|------|
| auth-ratelimit | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| circuitbreaker | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| timeout | ❌ | ❌ | ✅ | ❌ | ✅ | ✅ | ✅ |
| middleware | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| example | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| svc | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ |

## 🎯 推荐学习路径

1. **入门** - 从 `svc/` 开始，了解基础的 HTTP 服务
2. **中间件** - 学习 `timeout/` 和 `circuitbreaker/` 单个中间件使用
3. **组合使用** - 通过 `middleware/` 了解中间件组合
4. **完整功能** - 学习 `auth-ratelimit/` 全功能示例
5. **生产应用** - 参考 `example/` 构建完整的微服务应用

## 💡 最佳实践

### 中间件顺序
推荐的中间件执行顺序（从外到内）：
1. 日志中间件
2. 认证中间件  
3. 限流中间件
4. 超时控制中间件
5. 熔断器中间件
6. 业务处理器

### 监控端点
所有示例都提供了以下标准监控端点：
- `/status` - 查看中间件状态
- `/reset` - 重置统计信息（POST）

### 配置管理
- 使用结构化配置对象
- 支持回调函数自定义行为
- 启用指标统计便于监控

## 🔍 故障排除

### 编译错误
如果遇到编译错误，请检查：
1. Go 版本是否为 1.21+
2. 模块依赖是否完整：`go mod tidy`
3. 是否在正确的目录下运行

### 运行时错误
如果服务启动失败，请检查：
1. 端口是否被占用
2. 权限是否足够
3. 依赖服务（如 etcd、nacos）是否运行

### 性能问题
如果遇到性能问题：
1. 调整中间件参数（超时时间、限流速率等）
2. 查看监控端点了解系统状态
3. 检查日志了解详细信息

## 📚 相关文档

- [中间件系统文档](../docs/middleware.md)
- [认证和限流文档](../docs/auth-ratelimit.md)
- [中间件总览](../docs/middleware-summary.md)

## 🤝 贡献

欢迎提交新的示例或改进现有示例！请确保：
1. 代码风格一致
2. 包含详细注释
3. 提供使用说明
4. 通过编译测试
